<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Overview · Blindsight</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='docs'/>
<link rel="canonical" href="/blindsight/extending/overview.html"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../js/page.js"></script>
<script type="text/javascript" src="../js/warnOldVersion.js"></script>
<script type="text/javascript" src="../js/groups.js"></script>
<link rel="stylesheet" type="text/css" href="../lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="../css/page.css"/>

<!--
<link rel="shortcut icon" href="../images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Blindsight
</a>
<div class="version-number">
1.2.1
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../setup/index.html" class="page">Setup</a>
  <ul>
    <li><a href="../setup/logstash.html" class="page">Logback with Logstash</a></li>
    <li><a href="../setup/generic.html" class="page">Generic</a></li>
  </ul></li>
  <li><a href="../usage/index.html" class="page">Usage</a>
  <ul>
    <li><a href="../usage/overview.html" class="page">Overview</a></li>
    <li><a href="../usage/resolvers.html" class="page">Logger Resolvers</a></li>
    <li><a href="../usage/dsl.html" class="page">Structured DSL</a></li>
    <li><a href="../usage/typeclasses.html" class="page">Type Classes</a></li>
    <li><a href="../usage/slf4j.html" class="page">SLF4J API</a></li>
    <li><a href="../usage/fluent.html" class="page">Fluent API</a></li>
    <li><a href="../usage/semantic.html" class="page">Semantic API</a></li>
    <li><a href="../usage/flow.html" class="page">Flow API</a></li>
    <li><a href="../usage/conditional.html" class="page">Conditional Logging</a></li>
    <li><a href="../usage/context.html" class="page">Contextual Logging</a></li>
    <li><a href="../usage/sourcecode.html" class="page">Source Code</a></li>
  </ul></li>
  <li><a href="../extending/index.html" class="page">Extending</a>
  <ul>
    <li><a href="../extending/overview.html" class="active page">Overview</a></li>
  </ul></li>
  <li><a href="../benchmarks.html" class="page">Benchmarks</a></li>
  <li><a href="../principles.html" class="page">Principles</a></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title"><a href="../index.html">Blindsight</a></div>

<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Blindsight
</a>
<div class="version-number">
1.2.1
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../setup/index.html" class="page">Setup</a>
  <ul>
    <li><a href="../setup/logstash.html" class="page">Logback with Logstash</a></li>
    <li><a href="../setup/generic.html" class="page">Generic</a></li>
  </ul></li>
  <li><a href="../usage/index.html" class="page">Usage</a>
  <ul>
    <li><a href="../usage/overview.html" class="page">Overview</a></li>
    <li><a href="../usage/resolvers.html" class="page">Logger Resolvers</a></li>
    <li><a href="../usage/dsl.html" class="page">Structured DSL</a></li>
    <li><a href="../usage/typeclasses.html" class="page">Type Classes</a></li>
    <li><a href="../usage/slf4j.html" class="page">SLF4J API</a></li>
    <li><a href="../usage/fluent.html" class="page">Fluent API</a></li>
    <li><a href="../usage/semantic.html" class="page">Semantic API</a></li>
    <li><a href="../usage/flow.html" class="page">Flow API</a></li>
    <li><a href="../usage/conditional.html" class="page">Conditional Logging</a></li>
    <li><a href="../usage/context.html" class="page">Contextual Logging</a></li>
    <li><a href="../usage/sourcecode.html" class="page">Source Code</a></li>
  </ul></li>
  <li><a href="../extending/index.html" class="page">Extending</a>
  <ul>
    <li><a href="../extending/overview.html" class="active page">Overview</a></li>
  </ul></li>
  <li><a href="../benchmarks.html" class="page">Benchmarks</a></li>
  <li><a href="../principles.html" class="page">Principles</a></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<span id="version-warning"></span>

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="../index.html">Blindsight</a></li>
  <li><a href="../extending/index.html">Extending</a></li>
  <li>Overview</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#overview" name="overview" class="anchor"><span class="anchor-link"></span></a>Overview</h1>
<p>In SLF4J, you have a logging API that looks like this: </p>
<pre class="prettyprint"><code class="language-java">public interface Logger {
  boolean isInfoEnabled();
  void info(String message);
}
</code></pre>
<p>In Blindsight, the API and the logging levels are all traits, and the <code>LoggerAPI</code> is a composition of those traits. </p>
<pre class="prettyprint"><code class="language-scala"><br/>trait SLF4JLoggerComponent[P, M] {
  type Predicate &lt;: P
  type Method &lt;: M
  type Self
}

object SLF4JLoggerAPI {
  trait Info[P, M] extends SLF4JLoggerComponent[P, M] {
    def isInfoEnabled: Predicate
    def info: Method
  }
}

trait SLF4JLoggerAPI[P, M]
    extends SLF4JLoggerComponent[P, M]
    with SLF4JLoggerAPI.Trace[P, M]
    with SLF4JLoggerAPI.Debug[P, M]
    with SLF4JLoggerAPI.Info[P, M]
    with SLF4JLoggerAPI.Warn[P, M]
    with SLF4JLoggerAPI.Error[P, M]
</code></pre>
<p>The logger itself just puts together the appropriate predicates and methods.</p>
<pre class="prettyprint"><code class="language-scala">object SLF4JLogger {

  abstract class Base[M: ClassTag](core: CoreLogger) extends SLF4JLogger[M] {
    override type Self      = SLF4JLogger[M]
    override type Method    = M
    override type Predicate = SimplePredicate

    override val underlying: Logger = core.underlying

    override val markers: Markers = core.markers

    override val isTraceEnabled: Predicate = core.predicate(TRACE)
    override val isDebugEnabled: Predicate = core.predicate(DEBUG)
    override val isInfoEnabled: Predicate  = core.predicate(INFO)
    override val isWarnEnabled: Predicate  = core.predicate(WARN)
    override val isErrorEnabled: Predicate = core.predicate(ERROR)
  }

  /**
   * A logger that provides &quot;strict&quot; logging that only takes type class aware arguments.
   */
  class Strict(core: CoreLogger) extends SLF4JLogger.Base[StrictSLF4JMethod](core) {
    override val trace: Method = new StrictSLF4JMethod.Impl(TRACE, core)
    override val debug: Method = new StrictSLF4JMethod.Impl(DEBUG, core)
    override val info: Method  = new StrictSLF4JMethod.Impl(INFO, core)
    override val warn: Method  = new StrictSLF4JMethod.Impl(WARN, core)
    override val error: Method = new StrictSLF4JMethod.Impl(ERROR, core)

    override def withMarker[T: ToMarkers](markerInst: T): Self =
      new Strict(core.withMarker(markerInst))

    override def onCondition(condition: Condition): SLF4JLogger[StrictSLF4JMethod] =
      new Strict(core.onCondition(condition))
  }
}
</code></pre>
<p>You can see there&rsquo;s very little to the logger itself. The method API itself is as you&rsquo;d expect:</p>
<pre class="prettyprint"><code class="language-scala">trait StrictSLF4JMethod {

  def apply(
      message: Message
  )(implicit line: Line, file: File, enclosing: Enclosing): Unit

  def apply(
      throwable: Throwable
  )(implicit line: Line, file: File, enclosing: Enclosing): Unit

  def apply(
      message: Message,
      throwable: Throwable
  )(implicit line: Line, file: File, enclosing: Enclosing): Unit

  // ...
}
</code></pre>
<p>And from there, the method implementation does the work of resolving type class instances and calling through to SLF4J with the appropriate parameters.</p>
<pre class="prettyprint"><code class="language-scala">object StrictSLF4JMethod {

  class Impl(val level: Level, core: CoreLogger)
      extends StrictSLF4JMethod {

    @inline
    protected def markers: Markers = core.markers

    protected val parameterList: ParameterList = core.parameterList(level)

    override def apply(
        msg: =&gt; Message
    )(implicit line: Line, file: File, enclosing: Enclosing): Unit = {
      val m = collateMarkers
      if (m.nonEmpty) {
        if (executePredicate(m.marker)) {
          parameterList.markerMessage(m.marker, msg.toString)
        }
      } else {
        if (executePredicate()) {
          parameterList.message(msg.toString)
        }
      }
    }

    // ... and so on for the rest of the API.
  }
}
</code></pre>
<p>Breaking down the API means that you can pass through only the <code>LoggerMethod</code>, or assemble your custom logging levels. You have the option of extending <code>LoggerMethod</code> and <code>LoggerPredicate</code> with your own application specific logging API. Blindsight is designed to work with you so that adding new functionality is easy.</p>
<p>The <a href="/blindsight/api/com/tersesystems/blindsight/CoreLogger.html" title="com.tersesystems.blindsight.CoreLogger"><code>CoreLogger</code></a> contains the API independent code for logging. This exposes the state of the logger (markers, condition and underlying SLF4J logger), and exposes methods for building up additional state without tying that state to an end-user API.</p>
<pre class="prettyprint"><code class="language-scala">trait CoreLogger extends UnderlyingMixin with MarkerMixin with OnConditionMixin {
  type Self = CoreLogger

  def condition: Condition

  def sourceInfoBehavior: SourceInfoBehavior

  def predicate(level: Level): SimplePredicate

  def parameterList(level: Level): ParameterList
}
</code></pre>
<p>The <a href="/blindsight/api/com/tersesystems/blindsight/CoreLogger.html" title="com.tersesystems.blindsight.CoreLogger"><code>CoreLogger</code></a> mediates between the user level loggers and the <a href="/blindsight/api/com/tersesystems/blindsight/ParameterList.html" title="com.tersesystems.blindsight.ParameterList"><code>ParameterList</code></a>, which organizes the SLF4J logger by level. </p>
<pre class="prettyprint"><code class="language-scala">trait ParameterList {

  def executePredicate(): Boolean
  def executePredicate(marker: Marker): Boolean

  def message(msg: String): Unit
  def messageArg1(msg: String, arg: Any): Unit
  def messageArg1Arg2(msg: String, arg1: Any, arg2: Any): Unit
  def messageArgs(msg: String, args: Seq[_]): Unit
  def markerMessage(marker: Marker, msg: String): Unit
  def markerMessageArg1(marker: Marker, msg: String, arg: Any): Unit
  def markerMessageArg1Arg2(marker: Marker, msg: String, arg1: Any, arg2: Any): Unit
  def markerMessageArgs(marker: Marker, msg: String, args: Seq[_]): Unit

  def executeStatement(statement: Statement): Unit
}
</code></pre>
<p>There is a <a href="/blindsight/api/com/tersesystems/blindsight/ParameterList$$Conditional.html" title="com.tersesystems.blindsight.ParameterList.Conditional"><code>Conditional</code></a> which will only call out if the condition is met:</p>
<pre class="prettyprint"><code class="language-scala">object ParameterList {
  class Conditional(level: Level, core: CoreLogger) extends ParameterList {
    override def executePredicate(): Boolean = {
      core.condition(level) &amp;&amp; core.parameterList(level).executePredicate()
    }
    override def executePredicate(marker: Marker): Boolean = {
      core.condition(level) &amp;&amp; core.parameterList(level).executePredicate(marker)
    }

    override def message(msg: String): Unit =
      if (core.condition(level)) core.parameterList(level).message(msg)
    override def messageArg1(msg: String, arg: Any): Unit =
      if (core.condition(level)) core.parameterList(level).messageArg1(msg, arg)
    override def messageArg1Arg2(msg: String, arg1: Any, arg2: Any): Unit =
      if (core.condition(level)) core.parameterList(level).messageArg1Arg2(msg, arg1, arg2)
    override def messageArgs(msg: String, args: Seq[_]): Unit =
      if (core.condition(level)) core.parameterList(level).messageArgs(msg, args)
    override def markerMessage(marker: Marker, msg: String): Unit =
      if (core.condition(level)) core.parameterList(level).markerMessage(marker, msg)
    override def markerMessageArg1(marker: Marker, msg: String, arg: Any): Unit =
      if (core.condition(level)) core.parameterList(level).markerMessageArg1(marker, msg, arg)
    override def markerMessageArg1Arg2(marker: Marker, msg: String, arg1: Any, arg2: Any): Unit =
      if (core.condition(level))
        core.parameterList(level).markerMessageArg1Arg2(marker, msg, arg1, arg2)
    override def markerMessageArgs(marker: Marker, msg: String, args: Seq[_]): Unit =
      if (core.condition(level)) core.parameterList(level).markerMessageArgs(marker, msg, args)

    override def executeStatement(statement: Statement): Unit =
      if (core.condition(level)) core.parameterList(level).executeStatement(statement)
  }
}
</code></pre>
<p>Finally, the parameter lists are organized by level, so <code>executePredicate()</code> resolves to <code>underlying.isLoggingDebug()</code> if the level is <code>INFO</code>.</p>
<pre class="prettyprint"><code class="language-scala">object ParameterList {
  class Info(logger: org.slf4j.Logger) extends Impl(Level.INFO, logger) {
    override def executePredicate(): Boolean               = logger.isInfoEnabled
    override def executePredicate(marker: Marker): Boolean = logger.isInfoEnabled(marker)

    override def message(msg: String): Unit               = logger.info(msg)
    override def messageArg1(msg: String, arg: Any): Unit = logger.info(msg, arg)
    override def messageArg1Arg2(msg: String, arg1: Any, arg2: Any): Unit =
      logger.info(msg, arg1, arg2)
    override def messageArgs(msg: String, args: Seq[_]): Unit =
      logger.info(msg, args.asJava.toArray: _*)
    override def markerMessage(marker: Marker, msg: String): Unit = logger.info(marker, msg)
    override def markerMessageArg1(marker: Marker, msg: String, arg: Any): Unit =
      logger.info(marker, msg, arg)
    override def markerMessageArg1Arg2(marker: Marker, msg: String, arg1: Any, arg2: Any): Unit =
      logger.info(marker, msg, arg1, arg2)
    override def markerMessageArgs(marker: Marker, msg: String, args: Seq[_]): Unit =
      logger.info(marker, msg, args.asJava.toArray: _*)
  }
}
</code></pre>
<p>This is how Blindsight works.</p>
<div class="source-github">
The source code for this page can be found <a href="https://github.com/tersesystems/blindsight/tree/v1.2.1/docs/src/main/paradox/extending/overview.md">here</a>.
</div>

<div class="nav-next">
<p><strong>Next:</strong> <a href="../benchmarks.html">Benchmarks</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2020</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="../lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../js/magellan.js"></script>

<style type="text/css">@import "../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>
<script type="text/javascript">jQuery(function(jq){initOldVersionWarnings(jq, '1.2.1', 'https://tersesystems.github.io/blindsight')});</script>


</html>
